<div id="link-list" class="space-y-4" hx-get="/" hx-select="#link-list" {% if has_pending %}hx-trigger="every 2s"{% endif %} hx-swap="outerHTML">
  
    {% for link in links %}
    <div class="bg-white p-6 rounded-lg shadow border-l-4 transition duration-500 ease-in-out {% if link.status == 'COMPLETED' %}border-green-500{% elif link.status == 'FAILED' %}border-red-500{% elif link.status == 'RECOMMENDED' %}border-purple-500{% else %}border-yellow-500{% endif %}">
      
      <div class="flex justify-between items-start mb-3">
        <span class="text-xs font-bold px-2 py-1 rounded {% if link.status == 'COMPLETED' %}bg-green-100 text-green-800{% elif link.status == 'FAILED' %}bg-red-100 text-red-800{% elif link.status == 'RECOMMENDED' %}bg-purple-100 text-purple-800{% else %}bg-yellow-100 text-yellow-800{% endif %}">
          {% if link.status == 'RECOMMENDED' %}AI추천{% else %}{{ link.status }}{% endif %}
        </span>
        <span class="text-xs text-gray-400">
          {{ link.created_at|date:"Y-m-d H:i" }}
        </span>
      </div>
  
      <div class="flex flex-col-reverse sm:flex-row gap-4 justify-between">
        <div class="flex-1 min-w-0">
          
          <h3 class="text-xl font-bold mb-2 break-keep">
            {% if link.status == 'RECOMMENDED' %}
              <a href="{% url 'convert_recommendation' link.id %}" target="_blank" class="text-purple-700 hover:text-purple-900 hover:underline">
                [추천] {{ link.title|default:link.url }}
              </a>
            {% else %}
              <a href="{{ link.url }}" target="_blank" class="hover:text-blue-600 hover:underline">
                {{ link.title|default:link.url }}
              </a>
            {% endif %}
          </h3>
  
          {% if link.summary %}
          <div class="bg-gray-50 p-4 rounded text-gray-700 text-sm mb-3 whitespace-pre-line animate-fade-in">
            {{ link.summary }}
          </div>
          {% endif %}
  
          {% if link.tags %}
          <div class="flex flex-wrap gap-2 mt-2">
            {% for tag in link.tags %}
            <span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full">#{{ tag }}</span>
            {% endfor %}
          </div>
          {% endif %}
  
          {% if link.status == 'RECOMMENDED' and not link.summary %}
          <p class="text-sm text-gray-400 mt-2">
            * 클릭하여 읽으면 AI 요약과 분석이 시작됩니다.
          </p>
          {% endif %}
        </div>
  
        {% if link.image_url %}
        <div class="flex-shrink-0 sm:ml-4">
          <img src="{{ link.image_url }}" alt="thumbnail" class="w-full h-48 sm:w-32 sm:h-32 object-cover rounded-lg shadow-sm border border-gray-100" referrerpolicy="no-referrer" onerror="this.style.display='none';" />
        </div>
        {% endif %}
      </div>
    </div>
    
    {% empty %}
    <div class="text-center text-gray-500 py-10">
      아직 저장된 뉴스가 없습니다.
    </div>
    {% endfor %}
  </div>