{% if total_count == 0 %}
  {% include 'links/partials/stats_empty.html' %}
{% else %}

<div id="stats-root"
     data-cat-labels='{{ cat_labels|safe }}'
     data-cat-data='{{ cat_data|safe }}'
     data-tag-labels='{{ tag_labels|safe }}'
     data-tag-data='{{ tag_data|safe }}'
     data-trend-labels='{{ trend_labels|safe }}'
     data-trend-data='{{ trend_data|safe }}'>

  <div class="bg-gradient-to-r from-indigo-600 to-purple-600 rounded-xl p-8 text-white shadow-2xl mb-8 transform hover:scale-[1.01] transition duration-300">
    <div class="flex flex-col md:flex-row items-center justify-between">
      <div>
        <p class="text-indigo-200 font-semibold mb-1 tracking-wider uppercase text-sm">My Reading Persona</p>
        <h2 class="text-4xl md:text-5xl font-extrabold mb-2 break-keep">
          {{ persona.title }}
        </h2>
        <p class="text-lg opacity-90">
          ì´ <span class="font-bold text-yellow-300">{{ total_count }}</span>ê°œì˜ ê¸°ì‚¬ë¥¼ ì„­ë µí•˜ì…¨êµ°ìš”!
        </p>
      </div>

      <div class="mt-6 md:mt-0 flex flex-col items-center">
        <div class="bg-white/20 backdrop-blur-sm rounded-full px-6 py-2 border border-white/30">
          <span class="text-2xl font-bold">
            {% if persona.level == 'lv.1' %}Lv. 1{% elif persona.level == 'lv.2' %}Lv. 10{% else %}Lv. 99{% endif %}
          </span>
        </div>
        <p class="text-xs text-indigo-200 mt-2">ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼ì„ ëˆŒëŸ¬ì•¼ ê°±ì‹ ë©ë‹ˆë‹¤.</p>
      </div>
    </div>
  </div>

  {% if ai_insight %}
  <div class="bg-gray-50 border-l-4 border-indigo-500 p-6 rounded-r-lg shadow-sm mb-8 animate-fade-in-up">
    <div class="flex items-start">
      <div class="flex-shrink-0 text-3xl mr-4">ğŸ¤–</div>
      <div>
        <h3 class="text-lg font-bold text-gray-800 mb-1">AI ì§€ì‹ ë¸Œë¦¬í•‘</h3>
        <p class="text-gray-700 leading-relaxed whitespace-pre-line">{{ ai_insight }}</p>
      </div>
    </div>
  </div>
  {% endif %}

  <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
    <div class="bg-blue-600 rounded-lg p-6 text-white shadow-lg flex flex-col justify-between">
      <h3 class="text-sm font-semibold opacity-80 uppercase">Total Reads</h3>
      <p class="text-4xl font-bold mt-2">{{ total_count }} <span class="text-xl font-normal">ê±´</span></p>
    </div>

    <div class="bg-emerald-500 rounded-lg p-6 text-white shadow-lg flex flex-col justify-between">
      <h3 class="text-sm font-semibold opacity-80 uppercase">Main Interest</h3>
      <p class="text-3xl font-bold mt-2 truncate">{{ persona.category }}</p>
    </div>

    <div class="bg-orange-500 rounded-lg p-6 text-white shadow-lg flex flex-col justify-between">
      <h3 class="text-sm font-semibold opacity-80 uppercase">Current Level</h3>
      <p class="text-3xl font-bold mt-2">{{ persona.level|upper }}</p>
    </div>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
    <div class="bg-white p-6 rounded-lg shadow-md border border-gray-100">
      <h3 class="text-xl font-bold text-gray-800 mb-4">ğŸ“Š ì§€ì‹ ë°¸ëŸ°ìŠ¤</h3>
      <div class="h-64 relative">
        <canvas id="categoryChart"></canvas>
      </div>
    </div>

    <div class="bg-white p-6 rounded-lg shadow-md border border-gray-100">
      <h3 class="text-xl font-bold text-gray-800 mb-4">ğŸ”‘ í•µì‹¬ í‚¤ì›Œë“œ TOP 10</h3>
      <div class="h-64 relative">
        <canvas id="tagChart"></canvas>
      </div>
    </div>

    <div class="bg-white p-6 rounded-lg shadow-md border border-gray-100 lg:col-span-2">
      <h3 class="text-xl font-bold text-gray-800 mb-4">ğŸ“ˆ ì¼ì¼ í•™ìŠµ ì¶”ì´</h3>
      <div class="h-64 relative">
        <canvas id="trendChart"></canvas>
      </div>
    </div>
  </div>

</div>

{% endif %}